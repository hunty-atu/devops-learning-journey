Project 5: Configure an Amazon CloudFront distribution with an Amazon S3 origin

Task 5: Upload an object to an Amazon S3 bucket 
In this task, you upload an object to the previously created S3 bucket using the S3 console. 
Task 5.1: Upload an image to the S3 bucket folder for processing 
The following diagram shows the workflow: 
 
Upload a picture to test what you have built. 
100. Choose to download one image from the following options: 
• Open the context menu for the 
AWS.jpg
 link to download the picture to your computer. 
• Open the context menu for the 
MonaLisa.jpg
 link to download the picture to your computer. 
• Open the context menu for the 
HappyFace.jpg
 link to download the picture to your computer. 
• Name your file similar to InputFile.jpg. 
⚠ Caution: Firefox users – Make sure the saved file name is InputFile.jpg (not .jpeg). 
101. At the top of the AWS Management Console, in the search box, search for and choose S3. 
102. In the S3 Management Console, choose the xxxxx-labbucket-xxxxx bucket hyperlink. 
103. Choose the ingest/ link. 
104. Choose Upload. 
105. In the Upload window, choose Add files. 
106. Browse to and choose the XXXXX.jpg picture you downloaded. 
107. Choose Upload. 
At the top of the page, there is a message like, Upload succeeded. 
 Congratulations! You have successfully uploaded JPG images to S3 bucket. 

Task 6: Validate the processed file 
In this task, you validate the processed file from the logs generated by the function code through Amazon CloudWatch Logs. 
Task 6.1: Review Amazon CloudWatch Logs for Lambda activity 
You can monitor AWS Lambda functions to identify problems and view log files to assist in debugging. 
108. At the top of the AWS Management Console, in the search box, search for and choose Lambda. 
109. Choose the hyperlink for one of your Create- functions. 
110. Choose the Monitor tab. 
The console displays graphs showing the following: 
• Invocations: The number of times that the function was invoked. 
• Duration: The average, minimum, and maximum execution times. 
• Error count and success rate (%): The number of errors and the percentage of executions that completed without error. 
• Throttles: When too many functions are invoked simultaneously, they are throttled. The default is 1000 concurrent executions. 
• Async delivery failures: The number of errors that occurred when Lambda attempted to write to a destination or dead-letter queue. 
• Iterator Age: Measures the age of the last record processed from streaming triggers (Amazon Kinesis and Amazon DynamoDB Streams). 
• Concurrent executions: The number of function instances that are processing events. 
Log messages from Lambda functions are retained in Amazon CloudWatch Logs. 
111. Choose View CloudWatch logs . 
112. Choose the hyperlink for the newest Log stream that appears. 
113. Expand ▶ each message to view the log message details. 
The REPORT line provides the following details: 
• RequestId: The unique request ID for the invocation 
• Duration: The amount of time that your function&apos;s handler method spent processing the event 
• Billed Duration: The amount of time billed for the invocation 
• Memory Size: The amount of memory allocated to the function 
• Max Memory Used: The amount of memory used by the function 
• Init Duration: For the first request served, the amount of time it took the runtime to load the function and run code outside of the handler method 
In addition, the logs display any logging messages or print statements from the functions. This assists in debugging Lambda functions. 
 Note: Reviewing the logs you may notice that the Lambda function has been executed multiple times. This is because the Lambda function is receiving the test message posted to the SNS topic in task 2. Another one of logs was generated when the event notifications for your S3 bucket was created. The third log was generated when an object was uploaded the S3 bucket, and triggered the functions. 
Task 6.2: Validate the S3 bucket for processed files 
114. At the top of the AWS Management Console, in the search box, search for and choose S3. 
115. Choose the hyperlink for xxxxx-labbucket-xxxxx to enter the bucket. 
116. Navigate through these folders to find the resized images (for example, Thumbnail-AWS.jpg, MobileImage-MonaLisa.jpg). 
If you find the resized image here, you have successfully resized the image from its original to different formats. 
 Congratulations! You have successfully validated the processed image file from the logs generated by the function code through browsing Amazon S3 and Amazon CloudWatch Logs. 
Optional Tasks 
Challenge tasks are optional and are provided in case you have extra time remaining in your lab. You can complete the optional tasks or skip to the end of the lab. 
• (Optional) Task 1: Create a lifecycle configuration to delete files in the ingest bucket after 30 days. 
 Note: If you have trouble completing the optional task, refer to the Optional Task 1 Solution Appendix section at the end of the lab. 
• (Optional) Task 2: Add an SNS email notification to the existing SNS topi
 Note: If you have trouble completing the optional task, refer to the Optional Task 2 Solution Appendix section at the end of the lab. 
 
Conclusion 
 Congratulations! You now have successfully: 
• Created an Amazon SNS topic 
• Created Amazon SQS queues 
• Created event notifications in Amazon S3 
• Created AWS Lambda functions using preexisting code 
• Invoked an AWS Lambda function from SQS queues 
• Monitored AWS Lambda S3 functions through Amazon CloudWatch Logs 
End lab 
Follow these steps to close the console and end your lab. 
117. Return to the AWS Management Console. 
118. At the upper-right corner of the page, choose AWSLabsUser, and then choose Sign out. 
119. Choose End Lab and then confirm that you want to end your lab. 
For more information about AWS Training and Certification, see https://aws.amazon.com/training/. 
Your feedback is welcome and appreciated. If you would like to share any feedback, suggestions, or corrections, please provide the details in our AWS Training and Certification Contact Form. 
Appendix 
 
Optional Task 1 Solution: Create a lifecycle configuration to delete files in the ingest bucket after 30 days 
120. At the top of the AWS Management Console, in the search box, search for and choose S3. 
121. On the Buckets page, choose the xxxxx-labbucket-xxxxx bucket. 
122. Choose the Management tab. 
123. In the Lifecycle rules section, choose Create lifecycle rule 
124. In the Lifecycle rule configuration section, configure the following: 
• Lifecycle rule name: Enter cleanup. 
• Choose a rule scope: Choose Limit the scope of this rule using one or more filters. 
125. In the Filter type section, configure the following: 
• Prefix: Enter ingest/. 
126. In the Lifecycle rule actions section, configure the following: 
• Select ☑ Expire current versions of objects and ☑ Permanently delete noncurrent versions of objects. 
• Enter the following values in the new boxes that open. 
o Days after object creation: Enter 30. 
o Days after objects become noncurrent: Enter 1. 
127. Choose Create rule 
 
Optional Task 2 Solution: Add an SNS email notification to the existing SNS topic 
128. At the top of the AWS Management Console, in the search box, search for and choose Simple Notification Service. 
129. In the left navigation pane, choose Subscriptions 
130. On the Subscriptions page, choose Create subscription. 
131. On the Create subscription page, in the Details section, configure the following: 
• Topic ARN: Choose the ARN of the topic created. 
• Protocol: Choose Email. 
• Endpoint: Enter an email address. 
132. Choose Create subscription. 
The console creates the subscription and opens the subscription&apos;s Details page.

 Note: You must confirm the subscription before the email address can start to receive messages. 
133. To confirm a subscription, check your email inbox and choose Confirm subscription in the email from Amazon SNS. 
134. Amazon SNS opens your web browser and displays a subscription confirmation with your subscription ID. 

